import React, { createContext, useState, useContext, ReactNode, useCallback } from 'react';

type Language = 'en' | 'zh';

interface I18nContextProps {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string, params?: Record<string, string | number>) => string;
}

const I18nContext = createContext<I18nContextProps | undefined>(undefined);

const translations: Record<Language, Record<string, string>> = {
  en: {
    'menu.dashboard': 'Home',
    'menu.wdrAnalyze': 'WDR Analysis',
    'menu.wdrComparison': 'WDR Comparison',
    'menu.visualizer': 'Plan Visualizer',
    'menu.plandiff': 'Plan Diff',
    'menu.thresholds': 'Thresholds',
    'header.role': 'DBA Administrator',
    'dash.welcome': 'Welcome to WDRProbe',
    'dash.tagline': 'GaussDB WDR Intelligent Analysis Expert',
    'dash.description': 'WDRProbe is a professional tool for diagnosing GaussDB performance bottlenecks. By parsing WDR reports, we provide health scores, multi-dimensional comparisons, and expert-level SQL tuning suggestions.',
    'dash.steps.title': 'Three Steps to Performance Diagnosis',
    'dash.step1.title': '1. Global View',
    'dash.step1.desc': 'Upload WDR to identify core wait events and workload patterns.',
    'dash.step2.title': '2. Dimension Compare',
    'dash.step2.desc': 'Use Baseline comparison to lock down the root cause of performance regression (e.g. Index to Seq Scan changes).',
    'dash.step3.title': '3. Tuning Closure',
    'dash.step3.desc': 'Visualize plans and apply expert rules to fix sampling bias and skew risks.',
    'dash.action.start': 'Analyze',
    'dash.action.compare': 'Compare',
    'dash.action.visualize': 'Visualize',
    'dash.recentAnalyses': 'Recent Reports',
    'dash.instanceOverview': 'Instance Health',
    'dash.lastReport': 'Latest',
    'dash.score': 'Score',
    'dash.viewDetail': 'Detail',
    'dash.view': 'View All',
    
    // WDR Analyze
    'wdr.tab.overview': 'Overview',
    'wdr.tab.wait': 'Wait Events',
    'wdr.tab.sql': 'Top SQL',
    'wdr.tab.obj': 'Objects',
    'wdr.tab.settings': 'Configs',
    'wdr.upload.title': 'Analysis Center',
    'wdr.upload.desc': 'Please upload a GaussDB WDR HTML report to start analysis.',
    'wdr.upload.btn': 'Choose File',
    'wdr.upload.drag': 'Supports drag and drop upload',
    'wdr.analyzing': 'Analyzing...',
    'wdr.risk.none': 'No major performance risks detected.',
    'wdr.issue.bufferHit': 'Low Buffer Hit ({val}%)',
    'wdr.issue.bufferHitDesc': 'Buffer hit is below 95%. This often indicates heavy I/O and inefficient full table scans.',
    'wdr.issue.deadTup': 'Table Bloat Risk',
    'wdr.issue.deadTupDesc': 'Table {table} has {count} dead tuples. High bloat may trigger unexpected sampling bias.',
    'wdr.issue.skew': 'Partition Skew Alert',
    'wdr.issue.skewDesc': 'Detected high Seq Scans on table {table} with many dead tuples. This is a typical sign of stats sampling bias.',
    
    // WDR Comparison
    'wdr.comp.title': 'Multi-Dimensional Comparison',
    'wdr.comp.reset': 'Reset',
    'wdr.comp.baseline': 'Baseline (R1)',
    'wdr.comp.target': 'Comparison (R2)',
    'wdr.comp.uploadBase': 'Upload Baseline',
    'wdr.comp.addTarget': 'Add Target',
    'wdr.comp.empty': 'Upload at least a Baseline and a Target report to compare.',
    'wdr.comp.insights': 'Expert Insights',
    'wdr.comp.keyMetrics': 'System Metrics',
    'wdr.comp.topWait': 'Wait Events Delta',
    'wdr.comp.topSql': 'SQL Performance Delta',
    'wdr.comp.eventName': 'Event Name',
    'wdr.comp.waits': 'Waits',
    'wdr.comp.avg': 'Avg',
    'wdr.comp.max': 'Max',
    'wdr.comp.baseWaits': 'Base Waits',
    'wdr.comp.baseAvg': 'Base Avg',
    'wdr.comp.baseMax': 'Base Max',
    'wdr.comp.action': 'Tuning',
    'wdr.comp.notFound': 'SQL missing in this report',
    'wdr.comp.uniqueId': 'Unique SQL ID',
    'wdr.comp.sqlDetail': 'SQL Comparison Detail',
    'wdr.comp.sqlText': 'SQL Text',
    'wdr.comp.perfComp': 'Performance Metrics Breakdown',
    'wdr.comp.user': 'User',
    'wdr.comp.metric.calls': 'Executions',
    'wdr.comp.metric.total': 'Total Time',
    'wdr.comp.metric.avg': 'Avg Time',
    'wdr.comp.metric.cpu': 'CPU Time',
    'wdr.comp.metric.io': 'IO Time',
    'wdr.comp.metric.rows': 'Rows',
    'wdr.comp.metric.lread': 'Logical Read',
    'wdr.comp.metric.cps': 'Calls/Sec',
    'wdr.comp.sort.total': 'Total Time',
    'wdr.comp.sort.avg': 'Avg Time',
    'wdr.comp.sort.diff': 'Time Diff',
    'wdr.comp.sort.freq': 'Freq Change',
    'wdr.comp.status.degraded': 'Degraded',
    'wdr.comp.status.improved': 'Improved',
    'wdr.comp.status.stable': 'Stable',

    // Plan Diff
    'diff.title': 'Plan Comparison (Diff)',
    'diff.loadSample': 'Load Sample',
    'diff.compare': 'Run Diff',
    'diff.mode.unified': 'Unified Input',
    'diff.mode.split': 'Side-by-Side',
    'diff.tip.unified': 'Paste both plans here. System will auto-detect the split point.',
    'diff.placeholder.unified': 'Paste Plan 1 and Plan 2 here...',
    'diff.placeholder.left': 'Paste Baseline Plan...',
    'diff.placeholder.right': 'Paste Target Plan...',
    'diff.baseline': 'Baseline Plan',
    'diff.target': 'Optimized Plan',
    'diff.col.operation': 'Operation',
    'diff.col.costTime': 'Cost / Time',
    'diff.col.rows': 'Rows',
    'diff.col.costPct': 'Cost %',
    'diff.metric.execTime': 'Execution Time',
    'diff.metric.time': 'Time',
    'diff.verdict.improved': 'Performance Improved',
    'diff.verdict.regressed': 'Performance Regressed',
    'diff.verdict.similar': 'No Significant Change',
    'diff.verdict.new': 'New Node',
    'diff.verdict.removed': 'Removed Node',
    'diff.analysis.title': 'Node-Level Analysis',
    'diff.analysis.newRisk': 'New Risk: {risk}',
    'diff.analysis.resolved': 'Resolved: {risk}',
    'diff.risk.diskSpill': 'Disk Spill Detected',
    'diff.risk.largeSeqScan': 'Large Seq Scan ({rows}k rows)',
    'diff.risk.highCost': 'Excessive Node Cost',
    'diff.risk.nestLoop': 'Risk of Nested Loop on Large Rows',
    'diff.risk.badEst': 'Significant Estimation Error',
    
    // Thresholds
    'thr.categories': 'Threshold Categories',
    'thr.config': 'Threshold Config',
    'thr.batchSave': 'Batch Save',
    'thr.templates': 'Templates',
    'thr.sysTemplates': 'System Templates',
    'thr.customTemplates': 'My Templates',
    'thr.key': 'Key',
    'thr.value': 'Value',
    'thr.unit': 'Unit',
    'thr.range': 'Range',
    'thr.action': 'Action',

    // KB
    'wdr.kb.title': 'DBA Knowledge Base',
    'wdr.kb.search': 'Search metrics...',
    'wdr.kb.efficiency.title': 'Efficiency Percentages',
    'wdr.kb.efficiency.desc': 'Overall health metrics. Values near 100% indicate an optimized environment.',
    'wdr.kb.bufferHit.title': 'Buffer Hit %',
    'wdr.kb.bufferHit.desc': 'Target > 99%. Low values cause high DataFileRead waits.',
    'wdr.kb.softParse.title': 'Soft Parse %',
    'wdr.kb.softParse.desc': 'Target > 95%. Low values indicate missing bind variables.',
    'wdr.kb.effectiveCpu.title': 'Effective CPU %',
    'wdr.kb.effectiveCpu.desc': 'Percentage of CPU time spent on actual DB work rather than overhead.',
    'wdr.kb.walWrite.title': 'WAL Write NoWait %',
    'wdr.kb.walWrite.desc': 'Target > 99%. Low values indicate log writing contention.',
    'wdr.kb.nonParseCpu.title': 'Non-Parse CPU %',
    'wdr.kb.nonParseCpu.desc': 'CPU used for non-parsing activities. Higher is better.',
    
    // Wait Event Descriptions
    'desc.wait.LockMgrLock': 'Table/Tuple level locking contention. Check for long transactions or DDLs.',
    'desc.wait.WALSync': 'Disk IO bottleneck on WAL write. Check disk latency or high commit rate.',
    'desc.wait.DataFileRead': 'Physical IO read wait. Usually caused by full table scans or insufficient memory.',
    'desc.wait.DataFileWrite': 'Physical IO write wait. Check for massive batch updates.',
    
    // Risk Messages
    'wdr.risk.lock.mgr.title': 'Severe Lock Contention',
    'wdr.risk.lock.mgr.desc': 'LockMgrLock waits increased significantly. High risk of transaction chain blocking.',
    'wdr.risk.lock.sinval.title': 'Catalog Cache Contention',
    'wdr.risk.lock.sinval.desc': 'SInvalWriteLock surge detected. Often caused by excessive DDL or partition management operations.',

    // Visualizer Specific
    'vis.rule.014.title': 'Stats/Skew Risk',
    'vis.rule.014.desc': 'Est rows ({est}) vs Actual rows ({act}) mismatch.',
    'vis.rule.014.sugg': 'Detected sampling bias. If partition table, check CV > 1. Manual ANALYZE is required.',
    'vis.totalCost': 'Total Cost',
    'vis.node.cost': 'Cost',
    'vis.node.rows': 'Rows',

    'rep.id': 'Report ID',
    'rep.instance': 'Instance',
    'rep.generated': 'Generated At',
    'rep.period': 'Snap Period',
    'rep.status': 'Status',
    'rep.actions': 'Actions',
    'rep.search': 'Search Reports...',
    'rep.upload': 'Import WDR',
    'rep.uploadTitle': 'Import WDR Report',
    'rep.instanceName': 'Instance Name',
    'rep.desc': 'Description',
    'rep.file': 'WDR File (HTML)',
    'rep.clickUpload': 'Click or Drag to Upload',
    'rep.fileHint': 'Supports .html or .wdr files',
    'rep.cancel': 'Cancel',
    'rep.submit': 'Start Analysis',
    'rep.deleteTitle': 'Delete Report',
    'rep.deleteConfirm': 'Are you sure you want to delete report #{id}?',
    'rep.delete': 'Delete',
    'rep.loading': 'Loading data...',
    'rep.showing': 'Showing {start} to {end} of {total} items',
    'rep.prev': 'Prev',
    'rep.next': 'Next',
    'rep.metric': 'Metric',
    'rep.perSec': 'Per Sec',
    'rep.perTxn': 'Per Txn',
    'rep.summary.workload': 'Workload Profile',
    'rep.summary.efficiency': 'Efficiency',
    'rep.tab.summary': 'Summary',
    'rep.tab.sqlstats': 'Top SQL',
    'rep.tab.objstats': 'Object Stats',
    'rep.viewTitle': 'Report Detail',
    'rep.sql.elapsed': 'Elapsed',
    'rep.sql.cpu': 'CPU',
    'rep.sql.calls': 'Calls',
    'rep.sql.visualize': 'Visualize',
    'rep.sql.text': 'SQL Text',
    'rep.sql.orderBy': 'Order By',
    'rep.obj.seqScan': 'Seq Scan',
    'rep.obj.idxScan': 'Idx Scan',
    'rep.obj.liveTup': 'Live Tuples',
    'rep.obj.deadTup': 'Dead Tuples',
  },
  zh: {
    'menu.dashboard': '首页',
    'menu.wdrAnalyze': 'WDR 分析',
    'menu.wdrComparison': 'WDR 对比',
    'menu.visualizer': '计划可视化',
    'menu.plandiff': '计划比对',
    'menu.thresholds': '阈值配置',
    'header.role': '管理员',
    'dash.welcome': '欢迎使用 WDRProbe',
    'dash.tagline': 'GaussDB WDR 智能分析专家',
    'dash.description': 'WDRProbe 是专为 DBA 打造的 GaussDB 性能诊断工具。通过深度解析 WDR 报告，提供健康评分、多维度性能比对以及专家级的 SQL 执行计划优化建议。',
    'dash.steps.title': '性能诊断“三板斧”',
    'dash.step1.title': '1. 全局视角诊断',
    'dash.step1.desc': '通过 WDR 报告概览，识别核心等待事件与负载模式。',
    'dash.step2.title': '2. 维度对比定位',
    'dash.step2.desc': '引入 Baseline 基准，锁定性能退化根源（如索引转全表的计划突变）。',
    'dash.step3.title': '3. 精准调优闭环',
    'dash.step3.desc': '可视化 SQL 执行计划，识别并治理由于数据倾斜引起的采样偏差。',
    'dash.action.start': '开始分析',
    'dash.action.compare': '发起比对',
    'dash.action.visualize': '可视化',
    'dash.recentAnalyses': '最近报告',
    'dash.instanceOverview': '实例健康度',
    'dash.lastReport': '最近报告',
    'dash.score': '健康分',
    'dash.viewDetail': '查看详情',
    'dash.view': '查看全部',
    
    // WDR 分析
    'wdr.tab.overview': '总览',
    'wdr.tab.wait': '等待事件',
    'wdr.tab.sql': 'Top SQL',
    'wdr.tab.obj': '对象统计',
    'wdr.tab.settings': '配置参数',
    'wdr.upload.title': '智能分析中心',
    'wdr.upload.desc': '请上传 GaussDB WDR HTML 报告以开启深度分析。',
    'wdr.upload.btn': '选择报告',
    'wdr.upload.drag': '支持拖拽上传',
    'wdr.analyzing': '正在解析报告...',
    'wdr.risk.none': '当前未发现明显性能风险。',
    'wdr.issue.bufferHit': '缓存命中率偏低 ({val}%)',
    'wdr.issue.bufferHitDesc': '命中率低于 95% 阈值，通常伴随大量 I/O 等待，建议核查低效全表扫描。',
    'wdr.issue.deadTup': '表膨胀风险',
    'wdr.issue.deadTupDesc': '表 {table} 含有 {count} 个死元组。严重膨胀可能触发不准确的统计信息采样。',
    'wdr.issue.skew': '分区表采样偏差预警',
    'wdr.issue.skewDesc': '表 {table} 在采样期间全扫异常且死元组较多。需防范因“中行类”采样偏差导致的索引失效。',

    // WDR 对比
    'wdr.comp.title': '多维度性能比对',
    'wdr.comp.reset': '重置',
    'wdr.comp.baseline': '基准报告 (R1)',
    'wdr.comp.target': '对比报告 (R2)',
    'wdr.comp.uploadBase': '上传基准报告',
    'wdr.comp.addTarget': '添加对比报告',
    'wdr.comp.empty': '请上传至少一份基准报告和一份对比报告以开始。',
    'wdr.comp.insights': '专家发现',
    'wdr.comp.keyMetrics': '系统指标对比',
    'wdr.comp.topWait': '等待事件差异',
    'wdr.comp.topSql': 'SQL 性能差异',
    'wdr.comp.eventName': '事件名称',
    'wdr.comp.waits': '等待次数',
    'wdr.comp.avg': '平均耗时',
    'wdr.comp.max': '最大耗时',
    'wdr.comp.baseWaits': '基准次数',
    'wdr.comp.baseAvg': '基准平均',
    'wdr.comp.baseMax': '基准最大',
    'wdr.comp.action': '调优',
    'wdr.comp.notFound': 'SQL 在此报告中缺失',
    'wdr.comp.uniqueId': '唯一 SQL ID',
    'wdr.comp.sqlDetail': 'SQL 对比详情',
    'wdr.comp.sqlText': 'SQL 文本',
    'wdr.comp.perfComp': '性能指标拆解',
    'wdr.comp.user': '用户',
    'wdr.comp.metric.calls': '执行次数',
    'wdr.comp.metric.total': '总耗时',
    'wdr.comp.metric.avg': '平均耗时',
    'wdr.comp.metric.cpu': 'CPU 时间',
    'wdr.comp.metric.io': 'IO 时间',
    'wdr.comp.metric.rows': '返回行数',
    'wdr.comp.metric.lread': '逻辑读',
    'wdr.comp.metric.cps': '每秒执行数',
    'wdr.comp.sort.total': '总耗时排序',
    'wdr.comp.sort.avg': '单次耗时排序',
    'wdr.comp.sort.diff': '差异值排序',
    'wdr.comp.sort.freq': '执行频率变动',
    'wdr.comp.status.degraded': '性能下降',
    'wdr.comp.status.improved': '性能提升',
    'wdr.comp.status.stable': '性能稳定',

    // Plan Diff
    'diff.title': '执行计划差异比对 (Plan Diff)',
    'diff.loadSample': '加载示例',
    'diff.compare': '开始比对',
    'diff.mode.unified': '混合输入',
    'diff.mode.split': '左右对比',
    'diff.tip.unified': '将两个计划依次粘贴在此处，系统将尝试自动切分识别。',
    'diff.placeholder.unified': '在此粘贴包含两个计划的完整文本...',
    'diff.placeholder.left': '在此粘贴基准计划 (Baseline)...',
    'diff.placeholder.right': '在此粘贴目标计划 (Target)...',
    'diff.baseline': '基准计划 (R1)',
    'diff.target': '优化计划 (R2)',
    'diff.col.operation': '算子名称',
    'diff.col.costTime': '成本/耗时',
    'diff.col.rows': '行数',
    'diff.col.costPct': '成本占比',
    'diff.metric.execTime': '执行耗时',
    'diff.metric.time': '耗时',
    'diff.verdict.improved': '性能提升',
    'diff.verdict.regressed': '性能退化',
    'diff.verdict.similar': '性能持平',
    'diff.verdict.new': '新增算子',
    'diff.verdict.removed': '已移除算子',
    'diff.analysis.title': '节点差异分析',
    'diff.analysis.newRisk': '新增风险: {risk}',
    'diff.analysis.resolved': '已解决风险: {risk}',
    'diff.risk.diskSpill': '存在下盘 (Disk Spill)',
    'diff.risk.largeSeqScan': '大表全扫 ({rows}k 行)',
    'diff.risk.highCost': '节点成本极高',
    'diff.risk.nestLoop': '大数据量 NestLoop 风险',
    'diff.risk.badEst': '统计信息严重失真',

    // Thresholds
    'thr.categories': '阈值分类',
    'thr.config': '阈值配置',
    'thr.batchSave': '批量保存',
    'thr.templates': '配置模板',
    'thr.sysTemplates': '系统内置模板',
    'thr.customTemplates': '我的自定义模板',
    'thr.key': '参数键',
    'thr.value': '当前值',
    'thr.unit': '单位',
    'thr.range': '推荐范围',
    'thr.action': '操作',
    
    // KB
    'wdr.kb.title': 'DBA 专家知识库',
    'wdr.kb.search': '搜索指标含义...',
    'wdr.kb.efficiency.title': '实例效率指标',
    'wdr.kb.efficiency.desc': '衡量数据库整体运行健康度的指标，接近 100% 表示系统运行在最优状态。',
    'wdr.kb.bufferHit.title': 'Buffer Hit (缓存命中率)',
    'wdr.kb.bufferHit.desc': '目标 > 99%。如果过低，表示数据大部分从磁盘读取，会引发 DataFileRead 等待。',
    'wdr.kb.softParse.title': 'Soft Parse (软解析率)',
    'wdr.kb.softParse.desc': '目标 > 95%。如果过低，说明 SQL 未使用绑定变量，导致大量硬解析消耗 CPU。',
    'wdr.kb.effectiveCpu.title': 'CPU 有效率',
    'wdr.kb.effectiveCpu.desc': '执行有效工作而非管理开销所消耗的 CPU 比例。',
    'wdr.kb.walWrite.title': 'WAL 写等待率',
    'wdr.kb.walWrite.desc': '日志写入是否流畅。若过低说明磁盘 I/O 存在瓶颈。',
    'wdr.kb.nonParseCpu.title': '非解析 CPU 占比',
    'wdr.kb.nonParseCpu.desc': '越高说明 CPU 更多用于数据处理而非 SQL 解析。',
    
    // 等待事件描述
    'desc.wait.LockMgrLock': '表级或行级锁竞争。请检查是否有长事务阻塞或 DDL 操作。',
    'desc.wait.WALSync': '日志持久化 IO 瓶颈。检查磁盘写入延迟或过高的提交频率。',
    'desc.wait.DataFileRead': '物理读 IO 等待。通常由全表扫描或内存不足引起。',
    'desc.wait.DataFileWrite': '物理写 IO 等待。检查是否存在大规模批量更新操作。',
    
    // 风险词条
    'wdr.risk.lock.mgr.title': '严重的锁竞争风险',
    'wdr.risk.lock.mgr.desc': 'LockMgrLock 等待显著增加。存在事务链条死锁或长时间阻塞的风险。',
    'wdr.risk.lock.sinval.title': '元数据缓存冲突',
    'wdr.risk.lock.sinval.desc': '检测到 SInvalWriteLock 激增。通常由密集的 DDL 或分区维护操作引起。',

    // 可视化
    'vis.rule.014.title': '统计信息失真/数据倾斜',
    'vis.rule.014.desc': '估算行数 ({est}) 与实际行数 ({act}) 存在量级偏差。',
    'vis.rule.014.sugg': '检测到采样偏差风险。若为分区表，请核查数据倾斜（CV > 1）。建议立即执行 ANALYZE。',
    'vis.totalCost': '总成本',
    'vis.node.cost': '估算成本',
    'vis.node.rows': '估算行数',

    'rep.id': '报告 ID',
    'rep.instance': '实例名称',
    'rep.generated': '生成时间',
    'rep.period': '采样时段',
    'rep.status': '解析状态',
    'rep.actions': '操作',
    'rep.search': '搜索报告...',
    'rep.upload': '导入报告',
    'rep.uploadTitle': '导入 WDR 报告',
    'rep.instanceName': '实例名称',
    'rep.desc': '描述说明',
    'rep.file': 'WDR 文件 (HTML)',
    'rep.clickUpload': '点击或拖拽文件上传',
    'rep.fileHint': '支持 .html 或 .wdr 格式',
    'rep.cancel': '取消',
    'rep.submit': '开始分析',
    'rep.deleteTitle': '删除确认',
    'rep.deleteConfirm': '确定要删除报告 #{id} 吗？此操作不可撤销。',
    'rep.delete': '删除',
    'rep.loading': '正在加载...',
    'rep.showing': '当前显示第 {start} 至 {end} 项，共 {total} 项',
    'rep.prev': '上一页',
    'rep.next': '下一页',
    'rep.metric': '指标',
    'rep.perSec': '每秒',
    'rep.perTxn': '每事务',
    'rep.summary.workload': '负载概况',
    'rep.summary.efficiency': '实例效率',
    'rep.tab.summary': '概览',
    'rep.tab.sqlstats': 'SQL 统计',
    'rep.tab.objstats': '对象统计',
    'rep.viewTitle': '报告详情',
    'rep.sql.elapsed': '总时长',
    'rep.sql.cpu': 'CPU 时间',
    'rep.sql.calls': '执行次数',
    'rep.sql.visualize': '计划可视化',
    'rep.sql.text': 'SQL 语句',
    'rep.sql.orderBy': '排序方式',
    'rep.obj.seqScan': '全表扫描',
    'rep.obj.idxScan': '索引扫描',
    'rep.obj.liveTup': '活动元组',
    'rep.obj.deadTup': '死元组',
  }
};

export const I18nProvider: React.FC<{ children: ReactNode }> = ({ children }) => {
  const [language, setLanguage] = useState<Language>('zh');

  const t = useCallback((key: string, params?: Record<string, string | number>) => {
    let text = translations[language][key] || key;
    if (params) {
      Object.entries(params).forEach(([k, v]) => {
        text = text.replace(`{${k}}`, String(v));
      });
    }
    return text;
  }, [language]);

  return (
    <I18nContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </I18nContext.Provider>
  );
};

export const useI18n = () => {
  const context = useContext(I18nContext);
  if (!context) {
    throw new Error('useI18n must be used within an I18nProvider');
  }
  return context;
};